//tidy up and add improvements