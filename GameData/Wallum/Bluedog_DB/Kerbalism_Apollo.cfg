@PART[bluedog_Apollo_Block2_ServiceModule]:NEEDS[ProfileDefault]:FINAL
{
	!MODULE[ModuleResourceConverter]:HAS[#ConverterName[Fuel?Cell]] {}
	
	MODULE
	{
		name = ProcessController
		resource = _FuelCell
		title = #KERBALISM_H2O2FuelCell_title//H2+O2 fuel cell
		capacity = 1
		valve_i = 1 // workaround until we have a better way to deal with dump valves
	}
	
	MODULE:NEEDS[FeatureReliability]
	{
		name = Reliability
		type = ProcessController
		title = #KERBALISM_FuelCell_title//Fuel Cell
		redundancy = Power Generation
		repair = Engineer
		mtbf = 72576000
		extra_cost = 1.0
		extra_mass = 0.5
	}
}

@PART[bluedog_LEM_Ascent_Cockpit]:NEEDS[ProfileDefault]:FINAL
{
	!MODULE[ModuleResourceConverter]:HAS[#ConverterName[Fuel?Cell]] {}
	
	%RESOURCE[ElectricCharge]
	{
		%amount = 12500
		%maxAmount = 12500
	}
}

@PART[bluedog_Apollo_Block3_MissionModule]:NEEDS[ProfileDefault]:FINAL
{
	%RESOURCE[ElectricCharge]
	{
		%amount = 650
		%maxAmount = 650
	}
}

//60k is needed for the B3 mission types, as a 2 day travel time to station is common
@PART[bluedog_Apollo_Block3_ServiceModule]:NEEDS[ProfileDefault]:FINAL
{
	%RESOURCE[ElectricCharge]
	{
		%amount = 60000
		%maxAmount = 60000
	}
}

@PART[bluedog_Saturn_VFB_MissionModule]:NEEDS[ProfileDefault]:FINAL
{
	//3 kerbals for 400 days
	@RESOURCE[Food]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @amount *= 400
        @maxAmount *= 400
	}    
	@RESOURCE[Water]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @amount *= 400
        @maxAmount *= 400
	}
	@RESOURCE[Oxygen]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @amount *= 400
        @maxAmount *= 400
	}
}

@PART[bluedog_Skylab_Airlock]:NEEDS[ProfileDefault]:FINAL
{
	//3 kerbals for 240 days
	//Skylab was occuiped for ~170 days with a Skylab 5 noted for 20
	//Skylab also noted to have 24 man-months of supplies
	@RESOURCE[Food]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @amount *= 240
        @maxAmount *= 240
	}    
	@RESOURCE[Water]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @amount *= 240
        @maxAmount *= 240
	}
	@RESOURCE[Oxygen]
	{
		@amount = 3
		@maxAmount = 3
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @amount *= 240
        @maxAmount *= 240
	}
}

@PART[bluedog_Spacelab_Adapter]:NEEDS[ProfileDefault]:FINAL
{
	//4 kerbals for 1 year, based from ETS missions
	//less water and oxygen
	@RESOURCE[Food]
	{
		@amount = 4
		@maxAmount = 4
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/FOOD$
        @amount *= 360
        @maxAmount *= 360
	}    
	@RESOURCE[Water]
	{
		@amount = 4
		@maxAmount = 4
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/WATER$
        @amount *= 60
        @maxAmount *= 360
	}
	@RESOURCE[Oxygen]
	{
		@amount = 4
		@maxAmount = 4
        @amount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @maxAmount *= #$@WALLUMCONFIG/LIFESUPPORT/OXYGEN$
        @amount *= 60
        @maxAmount *= 360
	}
}

@PART[bluedog_Spacelab_Adapter]:NEEDS[ProfileDefault]:FINAL
{
	//ETS timing suggests it would have water/oxygen recylcing
	@MODULE[Configure]:HAS[#title[Pod]]
	{
		@slots = 5
	}
	
	//@MODULE[ProcessController]:HAS[#resource[_Scrubber]]
	//{
	//	@capacity = 4
	//}
	
	@MODULE[ProcessController]:HAS[#resource[_WaterRecycler]]
	{
		@capacity = 8.4
	}
	
	MODULE
	{
		name = ProcessController
		resource = _WaterElectrolysis
		title = #KERBALISM_WaterElectrolysis_title//Water electrolysis
		capacity = 0.02 //0.25
	}

	MODULE
	{
		name = ProcessController
		resource = _Sabatier
		title = #KERBALISM_SabatierProcess_title//Sabatier process
		capacity = 4
		valve_i = 2 // workaround until we have a better way to deal with dump valves
	}
	
	@MODULE[Configure]:HAS[#title[Pod]]
	{
		SETUP
		{
			name = Water Electrolysis
			desc = #KERBALISM_WaterElectrolysis_desc//Split <b>Water</b> into its <b>Hydrogen</b> and <b>Oxygen</b> components.

			MODULE
			{
				type = ProcessController
				id_field = resource
				id_value = _WaterElectrolysis
				mass = 0.05
				cost = 500
			}
		}

		SETUP
		{
			name = Sabatier Process
			desc = #KERBALISM_SabatierProcess_desc//<b>Hydrogen</b> and <b>CarbonDioxide</b> react with a nickel catalyst to produce <b>Water</b> and <b>LiquidFuel</b>.

			MODULE
			{
				type = ProcessController
				id_field = resource
				id_value = _Sabatier
				mass = 0.05
				cost = 1500
			}
		}
	}
	
	RESOURCE
	{
		name = Hydrogen
		amount = 0
		maxAmount = 5000
	}
}

@PART[bluedog_Skylab_OWS,bluedog_Skylab_OWS_Wet]:NEEDS[ProfileDefault]:FINAL
{
	@tags ^= :$: sickbay shower napkin: 

	MODULE
	{
		name = Sickbay
		resource = _SickbayShower
		title = Shower
		desc = This is not a shower - but close your eyes and believe it. A dry napkin is placed into a special package. The package is filled with warm water from the onboard water dispenser. When the dry napkin is soaked, the astronaut breaks the package open and 'showers' with the home-made wet wipe.
		mass = 0.001
		cost = 50
		slots = 1
	}

	MODULE
	{
		name = Reliability
		type = Sickbay
		title = Shower
		redundancy = Life Support
		repair = true // anyone 
		mtbf = 10368000
		extra_cost = 0.005
		extra_mass = 0.001
	} 
}

@PART[bluedog_Skylab_OWS,bluedog_Skylab_OWS_Wet]:NEEDS[FeatureComfort]:AFTER[KerbalismDefault]
{
	@description ^= :$: Can be upgraded to contain a Treadmill with Vibration Isolation Stabilization System (TVIS). 
	@tags ^= :$: exercise: 

	MODULE:NEEDS[FeatureComfort]
	{
		name = Comfort
		desc = A treadmill designed to permit exercise in zero-g is included. The crew will love it.
		bonus = exercise
		slots = 1

		//UPGRADES
		//{
		//	UPGRADE
		//	{
		//		name__ = Upgrade-SkylabTreadmill
		//		techRequired__ = shortTermHabitation
		//		slots = 1
		//	}
		//}
	}

	MODULE:NEEDS[FeatureReliability]
	{
		name = Reliability
		type = Comfort
		title = Treadmill
		repair = Engineer
		mtbf = 36288000
		extra_cost = 0.25
		extra_mass = 0.05
	}
}


@PART[bluedog_Skylab_OWS]:NEEDS[Bluedog_DB]:BEFORE[KerbalismDefault]
{
	!MODULE[ModuleScienceLab] {}
	!MODULE[ModuleScienceConverter] {}
}